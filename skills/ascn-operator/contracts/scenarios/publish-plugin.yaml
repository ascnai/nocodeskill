id: publish-workspace-plugin
version: 0.0.4
description: Submit a workspace user plugin bundle and return user-category visibility state.

inputs:
  intent: publish_plugin
  workspace_id: "<uuid>"
  plugin_name: CustomerOps
  handlers:
    - User.FetchCustomer
    - User.UpsertCustomer

expected_calls:
  - control.docs.get
  - control.registry.details
  - control.plugins.list
  - control.plugins.validate_definition
  - control.plugins.create_plugin
  - control.plugins.update_plugin
  - control.plugins.get
  - control.plugins.list

expected_call_params:
  - tool: control.plugins.list
    params:
      include_definition: true

expected_outcome:
  status: success
  required_output_fields:
    - operations_executed
    - definition_id
    - plugin_name
    - handlers
    - visibility_state
    - next_action
